/* 
** 讀取、排序和列印一列整數型值。
*/
#include <stdlib.h>
#include <stdio.h>

/*	
** 該函數由'qsort'呼叫，用於比較整數型值。
*/
int
compare_integers( void const *a, void const *b )
{
    register int  const *pa = a; 
    register int  const *pb = b;

    return *pa > *pb ? 1 : *pa < *pb ? -1 : 0;
}

int
main()
{
    int  *array;
    int  n_values;
    int  i;

    /*
    ** 觀察共有多少個值。 
    */
    printf( "How many values are there? " );
    if( scanf( "%d", &n_values ) != 1 || n_values <= 0 ){ 
        printf( "Illegal number of values.\n" );
        exit( EXIT_FAILURE );
}

    /* 
    ** 分配記憶體，用於儲存這些值。 
    */ 
    array = malloc( n_values * sizeof( int ) );
    if( array == NULL ){
        printf( "Can't get memory for that many values.\n" );
        exit( EXIT_FAILURE );
}

    /*
    ** 讀取這些數值。
    */
    for( i = 0; i < n_values; i += 1 ){
        printf( "? " );
        if( scanf( "%d", array + i ) != 1 ){
            printf( "Error reading value #%d\n", i );
            free( array );
            exit( EXIT_FAILURE );
        }
    }

    /*
    ** 對這些值排序。
    */
    qsort( array, n_values, sizeof( int ), compare_integers );

    /*
    ** 列印這些值。
    */
    for( i = 0; i < n_values; i += 1 )
        printf( "%d\n", array[i] );

    /*
    ** 釋放記憶體並退出。
    */
    free( array );
    return EXIT_SUCCESS;
}

